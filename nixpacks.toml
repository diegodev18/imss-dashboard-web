[phases.setup]
nixPkgs = ["nodejs_22", "pnpm"]
env = { NODE_ENV = "production" }

[phases.install]
cmds = [
    "pnpm install --frozen-lockfile --filter backend",
    "pnpm install --frozen-lockfile --filter frontend",
]

[phases.build]
cmds = ["pnpm --filter frontend run build", "pnpm --filter backend run build"]

[start]
cmds = ["pnpm --filter frontend start", "pnpm --filter backend start"]

[variables]
NIXPACKS_PATH = "/app"
