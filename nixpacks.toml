[phases.setup]
nixPkgs = ["nodejs_23", "pnpm"]
env = { NODE_ENV = "production" }

[phases.install]
cmds = ["pnpm install --frozen-lockfile"]

[phases.build]
cmds = ["pnpm --filter frontend run build", "pnpm --filter backend run build"]

[start]
cmd = "pnpm dlx concurrently 'pnpm --filter backend start' 'pnpm --filter frontend preview'"

[variables]
NIXPACKS_PATH = "/app"
